## 1. Анализ и поиск проблем
    Проанализируйте схему и описание системы.
    Идентифицируйте существующие и потенциальные проблемные места. Напишите их список
#### Продуктовые проблемы

| **N** | **Проблема**                                                                          | **Возможные причины (верхнего уровня)**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|:------|:--------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1     | Клиенты не получают заказы                                                            | Вероятно, заказы зависают в промежуточных статусах - например, `SUBMITTED` или `MANUFACTURING_COMPLETED`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 2     | Внешние продавцы не получают заказы                                                   | Вероятно, заказы зависают в промежуточных статусах - например, `SUBMITTED` или `MANUFACTURING_COMPLETED`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 3     | Операторы жалуются на долгую прогрузку MES, фильтр по статусам и пагинация не помогли | Перегрузка MES API, перегрузка MES db, большой latency из-за размещения БД в облаке YC, а сервисов - в облаке Amazon                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 4     | Релизный цикл стал превышать 1 месяц                                                  | Можно, предположить, разное:<br/>- проблемы с качеством кода (например, из-за недостаточного покрытия тестами);<br/>- cлишком много фичей в одном релизе, из-за этого баги трудно дебажить и справлять;<br/>- команда разработки не успевает решать запланированные задачи в приемлемым качеством (capacity и velocity);<br/>- много времени занимает ручное тестирование и ретесты, явно известно, что отсутствуют автотесты;<br/>- неоптимизированные/долгие отдельные процессы в CI/CD; например, сборка занимает очень долго, хотя есть железные ресурсы это исправить;<br/>- неверная классификация багов, некоторые HIGH и HIGHEST баги мошут таковыми не являться |

### Архитектурные проблемы

| **N** | **Проблема**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | **Следствие**                                                                                                                                                                                                                                     |
|:------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1     | Отсутствие мониторингов                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Не понимаем:<br/> - какой текущий уровень нагрузки и куда масштабировать систему;<br/>- как релизы влияют на состояние системы<br/>- пропускаем аварии<br/>- откуда начинать поиск конкретных проблем                                             |
| 2     | Выбрана микросервисная архитектура, но некоторые нужные (применительно к системе) паттерны не соблюдаются в полной мере, например:<br/>- MES_API совмещает возможно разные бизнес-функции (внешний и внутренний API + расчет цены);<br/>- разные подходы к коммуникациям между сервисами, Event-Driven Architecture используется между MES_API - CRM_API, общение через Postgres или HTTP REST между SHOP_API и CRM_API<br/>- не решен вопрос распределенных транзакций по изменениям статусов заказов, для реализации паттерна SAGA не хватает Оркестрации, либо компенсирующих событий для Choreography | Усложнение и отсутствие унификации чревато:<br/>- сложность масштабирования<br/>- повышением риска ошибок и аварий;<br/> - ростом стоимости разработки и поддержки                                                                                |
| 3     | Антипаттерн для микросервисной архитектуры - Shared Database между Internet_shop и CRM;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Сложнее масштабировать, взаимное влияние, снижение надежности от совмещения бизнес-функций                                                                                                                                                        |
| 4     | Бэкенд сервисы и БД имеют по одному инстансу                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Перегрузки сервисов под ростом нагрузки<br/>- любая авария - даунтайм                                                                                                                                                                           |
| 5     | Нет API шлюза, cовмещение API для внешних и внутренних клиентов                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | - Нет единой точки входа для авторизации, маршрутизации и балансировки<br/>- Разные по характеру нагрузки пагубно влияют друг на друга, возможные риски безопасности<br/>- нельзя катить канареечные релизы (а с релизами проблемы, как мы знаем) |
| 6     | Микросервисы и БД находятся в разных облаках                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Сетевые задержки                                                                                                                                                                                                                                  |
| 7     | Не используется паттерн BFF                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Как минимум это упростило бы контракты фронта с бэком, изолировало бы фронт от внутренних API, позволило бы проще немного равзязать релизы фронта и бэкенда                                                                                       |


## 2. Инициативы
    Разработайте инициативы, которые необходимы для устранения нежелательных ситуаций. Запишите их в список
    Расставьте инициативы в порядке приоритета. Опишите ход своих рассуждений и ответьте на вопросы:
    - Какой вы видите целевую архитектуру через полгода?
    - Если бы у вас была возможность выполнить только три пункта из списка инициатив в ближайшие полгода, что бы вы выбрали и почему? 
    Не обязательно добавлять в список только эпики. Вы можете включить в план как крупные изменения, так и локальные задачи

| **Приоритет** | **Действие**                                                                                                                                                                                                                       | **Причины**                                                                                |
|:--------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------|
| 1             | Покрытие сервисов и БД мониторингами и настройка логирования (проверка, где не хватает, сбор логов в единую систему для анализа)                                                                                                   | Неясны точные причины продуктовых проблем, требуется повышение Observability               |
| 2             | Расширение команды devOps                                                                                                                                                                                                          | Для масштабных работ масштабированию, повышению Observability, оптимизации CI/CD пайплайна |
| 3             | Расширение команды бэкенд-разработки, как минимум 1 инженер С# для поддержки MES API                                                                                                                                               | Запланировано оптимизация MES API и разделение на несколько микросервисов                  |
| 4             | Добавление LB, горизонтальное масштабирование MES API, CRM-API, Shop-API, внедрение механизмов BackPressure, CircuitBraker                                                                                                         | Зависание заказов из-за перегрузок микросервисов                                           |
| 5             | Внедрение кэширования и оптимизация запросов в MES db                                                                                                                                                                              | Проблема с зависанием MES                                                                  |
| 6             | Покрытие сервисов трассировками                                                                                                                                                                                                    | Повышение наблюдаемости системы                                                            |
| 7             | Расширение команды тестирования и внедрение автотестов                                                                                                                                                                             | Ускорение тестирования и релизов                                                           |
| 8             | Расширение интеграционных тестов                                                                                                                                                                                                   | Сокращение потока багов при релизах                                                        |
| 9             | Объединение БД и микросервисов в одном облаке                                                                                                                                                                                      | Снижение latency                                                                           |
| 10            | Разделение MES API на внешнее и внутреннее, выделение микросервиса расчета цены                                                                                                                                                    | Разделение бизнес-функций для возможности раздельного масштабирования                      |
| 11            | Изменение CI/DI процесса - сократить объем изменений в релизах (например, можно сократить время спринта до 1 недели, либо не привязывать релизы к спринтам и выпускать релизы по мере готовности задач, хоть несколько раз в день) | Ускорение релизного пайплайна                                                              |
| 12            | Внедрение канареечных (по % аудитории) и инкрементальных (по % подов) релизов, фиче-флагов                                                                                                                                         | Ускорение релизного пайплайна                                                              |