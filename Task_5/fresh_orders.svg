<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1251px" preserveAspectRatio="none" style="width:1240px;height:1251px;background:#FFFFFF;" version="1.1" viewBox="0 0 1240 1251" width="1240px" zoomAndPan="magnify"><title>&#1053;&#1086;&#1074;&#1099;&#1077; &#1079;&#1072;&#1082;&#1072;&#1079;&#1099;: &#1095;&#1090;&#1077;&#1085;&#1080;&#1077; &#1080; async refresh &#1095;&#1077;&#1088;&#1077;&#1079; &#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1100; (no-cache, ETag/304)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="551.0244" x="340.7498" y="28.5352">&#1053;&#1086;&#1074;&#1099;&#1077; &#1079;&#1072;&#1082;&#1072;&#1079;&#1099;: &#1095;&#1090;&#1077;&#1085;&#1080;&#1077; &#1080; async refresh &#1095;&#1077;&#1088;&#1077;&#1079; &#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1100; (no-cache, ETag/304)</text><rect fill="none" height="491.8555" style="stroke:#000000;stroke-width:1.5;" width="815.2949" x="10" y="268.5293"/><rect fill="none" height="139.1738" style="stroke:#000000;stroke-width:1.5;" width="375.7627" x="20" y="364.4609"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="48.7524" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="52" x2="52" y1="118.9766" y2="1170.1113"/></g><g><title>other_service</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="133.4956" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="136.5049" x2="136.5049" y1="118.9766" y2="1170.1113"/></g><g><title>MES_API</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="346.9541" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="350.1455" x2="350.1455" y1="118.9766" y2="1170.1113"/></g><g><title>MES_CACHE .Redis.</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="661.9307" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="665.292" x2="665.292" y1="118.9766" y2="1170.1113"/></g><g><title>MES_DB</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="777.9321" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="781.5693" x2="781.5693" y1="118.9766" y2="1170.1113"/></g><g><title>Queue. orders-to-refresh</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="918.5864" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="922.2949" x2="922.2949" y1="118.9766" y2="1170.1113"/></g><g><title>Async worker</title><rect fill="#000000" fill-opacity="0.00000" height="1051.1348" width="8" x="1078.4907" y="118.9766"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1081.8779" x2="1081.8779" y1="118.9766" y2="1170.1113"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="30" y="116.0234">Client</text><ellipse cx="52.7524" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M52.7524,58.9883 L52.7524,85.9883 M39.7524,66.9883 L65.7524,66.9883 M52.7524,85.9883 L39.7524,100.9883 M52.7524,85.9883 L65.7524,100.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5049" x="30" y="1182.6465">Client</text><ellipse cx="52.7524" cy="1194.0996" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M52.7524,1202.0996 L52.7524,1229.0996 M39.7524,1210.0996 L65.7524,1210.0996 M52.7524,1229.0996 L39.7524,1244.0996 M52.7524,1229.0996 L65.7524,1244.0996" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="other_service"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.9814" x="85.5049" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.9814" x="92.5049" y="108.0234">other_service</text></g><g class="participant participant-tail" data-participant="other_service"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.9814" x="85.5049" y="1169.1113"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.9814" x="92.5049" y="1189.6465">other_service</text></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6172" x="316.1455" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6172" x="323.1455" y="108.0234">MES_API</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69.6172" x="316.1455" y="1169.1113"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55.6172" x="323.1455" y="1189.6465">MES_API</text></g><g class="participant participant-head" data-participant="Cache"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145.2773" x="593.292" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.2773" x="600.292" y="108.0234">MES_CACHE (Redis)</text></g><g class="participant participant-tail" data-participant="Cache"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="145.2773" x="593.292" y="1169.1113"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131.2773" x="600.292" y="1189.6465">MES_CACHE (Redis)</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66.7256" x="748.5693" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.7256" x="755.5693" y="108.0234">MES_DB</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66.7256" x="748.5693" y="1169.1113"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.7256" x="755.5693" y="1189.6465">MES_DB</text></g><g class="participant participant-head" data-participant="Q"><path d="M830.2949,92.4883 L1014.8779,92.4883 C1019.8779,92.4883 1019.8779,105.7324 1019.8779,105.7324 C1019.8779,105.7324 1019.8779,118.9766 1014.8779,118.9766 L830.2949,118.9766 C825.2949,118.9766 825.2949,105.7324 825.2949,105.7324 C825.2949,105.7324 825.2949,92.4883 830.2949,92.4883" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1014.8779,92.4883 C1009.8779,92.4883 1009.8779,105.7324 1009.8779,105.7324 C1009.8779,118.9766 1014.8779,118.9766 1014.8779,118.9766" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.583" x="830.2949" y="111.0234">Queue: orders-to-refresh</text></g><g class="participant participant-tail" data-participant="Q"><path d="M830.2949,1169.1113 L1014.8779,1169.1113 C1019.8779,1169.1113 1019.8779,1182.3555 1019.8779,1182.3555 C1019.8779,1182.3555 1019.8779,1195.5996 1014.8779,1195.5996 L830.2949,1195.5996 C825.2949,1195.5996 825.2949,1182.3555 825.2949,1182.3555 C825.2949,1182.3555 825.2949,1169.1113 830.2949,1169.1113" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1014.8779,1169.1113 C1009.8779,1169.1113 1009.8779,1182.3555 1009.8779,1182.3555 C1009.8779,1195.5996 1014.8779,1195.5996 1014.8779,1195.5996" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.583" x="830.2949" y="1187.6465">Queue: orders-to-refresh</text></g><g class="participant participant-head" data-participant="W"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.2256" x="1029.8779" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.2256" x="1036.8779" y="108.0234">Async worker</text></g><g class="participant participant-tail" data-participant="W"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.2256" x="1029.8779" y="1169.1113"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.2256" x="1036.8779" y="1189.6465">Async worker</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1233.5239" x="0" y="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="149.6318" y2="149.6318"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="152.6318" y2="152.6318"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="117.3398" x="558.092" y="138.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="99.0552" x="564.092" y="155.5449">&#1063;&#1090;&#1077;&#1085;&#1080;&#1077; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072;</text><g class="message" data-participant-1="Client" data-participant-2="API"><polygon fill="#181818" points="338.9541,220.2188,348.9541,224.2188,338.9541,228.2188,342.9541,224.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="52.7524" x2="344.9541" y1="224.2188" y2="224.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.1602" x="59.7524" y="188.8555">GET /orders/new?page=1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2466" x="59.7524" y="204.166">Cache-Control: no-cache</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.563" x="59.7524" y="219.4766">If-None-Match: &lt;ClientETag&gt;</text></g><g class="message" data-participant-1="API" data-participant-2="Cache"><polygon fill="#181818" points="653.9307,249.5293,663.9307,253.5293,653.9307,257.5293,657.9307,253.5293" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="659.9307" y1="253.5293" y2="253.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.2578" x="357.9541" y="248.7871">GET page:new:1</text></g><path d="M10,268.5293 L72.1387,268.5293 L72.1387,275.8398 L62.1387,285.8398 L10,285.8398 L10,268.5293" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="491.8555" style="stroke:#000000;stroke-width:1.5;" width="815.2949" x="10" y="268.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="25" y="282.0977">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149.1929" x="87.1387" y="281.1641">[cache HIT (TTL &#1074;&#1072;&#1083;&#1080;&#1076;&#1077;&#1085;)]</text><g class="message" data-participant-1="Cache" data-participant-2="API"><polygon fill="#181818" points="361.9541,303.1504,351.9541,307.1504,361.9541,311.1504,357.9541,307.1504" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="355.9541" x2="664.9307" y1="307.1504" y2="307.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.6108" x="367.9541" y="302.4082">{pageData, pageETag}</text></g><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="392.9541" y1="336.4609" y2="336.4609"/><line style="stroke:#181818;stroke-width:1;" x1="392.9541" x2="392.9541" y1="336.4609" y2="349.4609"/><line style="stroke:#181818;stroke-width:1;" x1="351.9541" x2="392.9541" y1="349.4609" y2="349.4609"/><polygon fill="#181818" points="361.9541,345.4609,351.9541,349.4609,361.9541,353.4609,357.9541,349.4609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.8813" x="357.9541" y="331.7188">compare(ClientETag, pageETag)</text></g><path d="M20,364.4609 L82.1387,364.4609 L82.1387,371.7715 L72.1387,381.7715 L20,381.7715 L20,364.4609" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="139.1738" style="stroke:#000000;stroke-width:1.5;" width="375.7627" x="20" y="364.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="35" y="378.0293">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.7446" x="97.1387" y="377.0957">[ETag &#1089;&#1086;&#1074;&#1087;&#1072;&#1083;]</text><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="63.7524,414.3926,53.7524,418.3926,63.7524,422.3926,59.7524,418.3926" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="57.7524" x2="349.9541" y1="418.3926" y2="418.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.4238" x="69.7524" y="398.3398">304 Not Modified</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2466" x="69.7524" y="413.6504">Cache-Control: no-cache</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20" x2="395.7627" y1="427.3926" y2="427.3926"/><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="63.7524,491.6348,53.7524,495.6348,63.7524,499.6348,59.7524,495.6348" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="57.7524" x2="349.9541" y1="495.6348" y2="495.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.3599" x="69.7524" y="444.9609">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2466" x="69.7524" y="460.2715">Cache-Control: no-cache</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.0391" x="69.7524" y="475.582">ETag: pageETag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.3315" x="69.7524" y="490.8926">Body: pageData</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="825.2949" y1="511.6348" y2="511.6348"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120.3608" x="15" y="522.2695">[MISS &#1080;&#1083;&#1080; TTL &#1080;&#1089;&#1090;&#1105;&#1082;]</text><g class="message" data-participant-1="Cache" data-participant-2="API"><polygon fill="#181818" points="361.9541,542.9004,351.9541,546.9004,361.9541,550.9004,357.9541,546.9004" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="355.9541" x2="664.9307" y1="546.9004" y2="546.9004"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.6621" x="367.9541" y="542.1582">MISS/expired</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="769.9321,572.2109,779.9321,576.2109,769.9321,580.2109,773.9321,576.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="775.9321" y1="576.2109" y2="576.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.6558" x="357.9541" y="571.4688">SELECT rows for page 1</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="361.9541,601.5215,351.9541,605.5215,361.9541,609.5215,357.9541,605.5215" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="355.9541" x2="780.9321" y1="605.5215" y2="605.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.9482" x="367.9541" y="600.7793">rows</text></g><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="392.9541" y1="634.832" y2="634.832"/><line style="stroke:#181818;stroke-width:1;" x1="392.9541" x2="392.9541" y1="634.832" y2="647.832"/><line style="stroke:#181818;stroke-width:1;" x1="351.9541" x2="392.9541" y1="647.832" y2="647.832"/><polygon fill="#181818" points="361.9541,643.832,351.9541,647.832,361.9541,651.832,357.9541,647.832" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.5103" x="357.9541" y="630.0898">compute pageETag</text></g><g class="message" data-participant-1="API" data-participant-2="Cache"><polygon fill="#181818" points="653.9307,673.1426,663.9307,677.1426,653.9307,681.1426,657.9307,677.1426" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="659.9307" y1="677.1426" y2="677.1426"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.9766" x="357.9541" y="672.4004">SET page:new:1 = {pageData, pageETag} (TTL)</text></g><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="63.7524,748.3848,53.7524,752.3848,63.7524,756.3848,59.7524,752.3848" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="57.7524" x2="349.9541" y1="752.3848" y2="752.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.3599" x="69.7524" y="701.7109">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.2466" x="69.7524" y="717.0215">Cache-Control: no-cache</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.0391" x="69.7524" y="732.332">ETag: pageETag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.3315" x="69.7524" y="747.6426">Body: pageData</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1233.5239" x="0" y="788.04"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="788.04" y2="788.04"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="791.04" y2="791.04"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="627.8945" x="302.8147" y="777.3848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="609.6099" x="308.8147" y="793.9531">&#1048;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1077; &#1089;&#1090;&#1072;&#1090;&#1091;&#1089;&#1072; &#1079;&#1072;&#1082;&#1072;&#1079;&#1072; &#1089; &#1086;&#1090;&#1087;&#1088;&#1072;&#1074;&#1082;&#1086;&#1081; &#1074; &#1086;&#1095;&#1077;&#1088;&#1077;&#1076;&#1100; &#1076;&#1083;&#1103; Refresh-Ahead &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; &#1074; &#1082;&#1101;&#1096;&#1077;</text><g class="message" data-participant-1="other_service" data-participant-2="API"><polygon fill="#181818" points="338.9541,828.0059,348.9541,832.0059,338.9541,836.0059,342.9541,832.0059" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="137.4956" x2="344.9541" y1="832.0059" y2="832.0059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.4585" x="144.4956" y="827.2637">PATCH /orders/{id}/status=...</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#181818" points="769.9321,857.3164,779.9321,861.3164,769.9321,865.3164,773.9321,861.3164" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="775.9321" y1="861.3164" y2="861.3164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280.23" x="357.9541" y="856.5742">UPDATE orders SET status=... WHERE id={id}</text></g><g class="message" data-participant-1="DB" data-participant-2="API"><polygon fill="#181818" points="361.9541,886.627,351.9541,890.627,361.9541,894.627,357.9541,890.627" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="355.9541" x2="780.9321" y1="890.627" y2="890.627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.5859" x="367.9541" y="885.8848">OK</text></g><g class="message" data-participant-1="API" data-participant-2="Q"><polygon fill="#181818" points="910.5864,915.9375,920.5864,919.9375,910.5864,923.9375,914.5864,919.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="350.9541" x2="916.5864" y1="919.9375" y2="919.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="482.5679" x="357.9541" y="915.1953">ENQUEUE orderId...   # orders &#1076;&#1083;&#1103; async &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072; &#1079;&#1072;&#1082;&#1072;&#1079;&#1086;&#1074; &#1074; &#1082;&#1101;&#1096;&#1077;</text></g><g class="message" data-participant-1="API" data-participant-2="other_service"><polygon fill="#181818" points="148.4956,945.248,138.4956,949.248,148.4956,953.248,144.4956,949.248" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="142.4956" x2="349.9541" y1="949.248" y2="949.248"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.3599" x="154.4956" y="944.5059">200 OK</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1233.5239" x="0" y="977.9033"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="977.9033" y2="977.9033"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1233.5239" y1="980.9033" y2="980.9033"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="527.665" x="352.9294" y="967.248"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="509.3804" x="358.9294" y="983.8164">&#1040;&#1089;&#1080;&#1085;&#1093;&#1088;&#1086;&#1085;&#1085;&#1086;&#1077; &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077; &#1080;&#1079;&#1084;&#1077;&#1085;&#1080;&#1074;&#1096;&#1080;&#1093;&#1089;&#1103; &#1079;&#1072;&#1082;&#1072;&#1079;&#1086;&#1074; &#1074; &#1089;&#1087;&#1080;&#1089;&#1082;&#1077; &#1079;&#1072;&#1082;&#1072;&#1079;&#1086;&#1074; &#1074; &#1082;&#1101;&#1096;&#1077;</text><g class="message" data-participant-1="W" data-participant-2="Q"><polygon fill="#181818" points="933.5864,1017.8691,923.5864,1021.8691,933.5864,1025.8691,929.5864,1021.8691" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="927.5864" x2="1081.4907" y1="1021.8691" y2="1021.8691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.5488" x="939.5864" y="1017.127">PULL batch orderId...</text></g><g class="message" data-participant-1="W" data-participant-2="DB"><polygon fill="#181818" points="792.9321,1047.1797,782.9321,1051.1797,792.9321,1055.1797,788.9321,1051.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="786.9321" x2="1081.4907" y1="1051.1797" y2="1051.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.4673" x="798.9321" y="1046.4375">SELECT rows where orderId in {ids}</text></g><g class="message" data-participant-1="DB" data-participant-2="W"><polygon fill="#181818" points="1070.4907,1076.4902,1080.4907,1080.4902,1070.4907,1084.4902,1074.4907,1080.4902" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="781.9321" x2="1076.4907" y1="1080.4902" y2="1080.4902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.9482" x="788.9321" y="1075.748">rows</text></g><g class="message" data-participant-1="W" data-participant-2="W"><line style="stroke:#181818;stroke-width:1;" x1="1082.4907" x2="1124.4907" y1="1109.8008" y2="1109.8008"/><line style="stroke:#181818;stroke-width:1;" x1="1124.4907" x2="1124.4907" y1="1109.8008" y2="1122.8008"/><line style="stroke:#181818;stroke-width:1;" x1="1083.4907" x2="1124.4907" y1="1122.8008" y2="1122.8008"/><polygon fill="#181818" points="1093.4907,1118.8008,1083.4907,1122.8008,1093.4907,1126.8008,1089.4907,1122.8008" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.0332" x="1089.4907" y="1105.0586">compute pageETag(n)</text></g><g class="message" data-participant-1="W" data-participant-2="Cache"><polygon fill="#181818" points="676.9307,1148.1113,666.9307,1152.1113,676.9307,1156.1113,672.9307,1152.1113" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="670.9307" x2="1081.4907" y1="1152.1113" y2="1152.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307.3472" x="682.9307" y="1147.3691">SET page:new:n = {pageData, pageETag(n)} (TTL)</text></g><!--SRC=[hLNBRjfG4DtxAqRf1gGw96rNLfsAXrLG8840OXCfSkrBi4fjQflIA8hKf8eQAQtIxhhfkbiQ1OMIXlp2zHzrvjhc4MXMNV0mCtFcp9a7lkMt6V0VVCmlWtC-07xD-to4h-lWN87WKt321_oM3yaq1Dqxi0rmMTDbNWkjV11yGFiryF7auIhu30dRaGtTQB77eDNq_TJJjMT9IT8Dtt4XsxQOxKiTtVKjm-hejW-EtsBkdiVSTvR1CCdy3tEkAoMjkfSk5rR83JyNZTbqDgz1OeUPbfSKRbbYikYOomXhBYEzxR8kWvKAVIZWk2PpFTbtvAXGuLQP1qWB9NgE-vgvmjwG95K5_dD6iE2Ot_4XlgEUeAfIM3d86qHSWPTQ3L9XifJDUYyw-ZvJrtTjGLVEEhRlEcq5OYbtxK9Jtd9i9fTqtsWfy3p48u4t94GaO14RGXESWhZAkgItVH0Oa2_K856h5O5VOezlaEOLqKrA48Q27BCxfFYSxkkF1H9bEKAlA8zmCPmtg0bBJ7bCVGcHqj9t4WBd2yN0bFXxX49qHQG2E1-mvVXGSaohQJ7pdo9WD6jxR2d8axKrsDvyG3_YeamOxjePnpm8dwbEWhPDYU2XLAXMSTv9811gOHU3a-0R7oqAHRufzhvZkSoS2fJBA53LYbgs1gxJyw29aq-PO1rzSfbfE5cNwDhrsOJfr1orjphNNb2NDalqEIdzVvr89J7ht_5O_17JFfru7Fy-AlKHMzwVEIRu41pJbJZXTtWb-ZWD8vo9tpY7zsy7JkHDS04xuUx9wHRJJVJXlp07JT5Dc0rTA7OKV0dEC3Ekr_mLYSKifslP_6JF3YtpAENvkj_rrDNLLMccM_LoBbtJekqN4a_ze97NTZImJ9K0fDd-RM_681K5jArANQj780MJ8W4UnPXHPU4HNLhHtCMOKMzCfKwhbUAMpfKSTpPipbT46VBRu1I57ICyfHeioIeE-wIHG_mRE4C6fzZ9YoKCPWWE7Y18xMX4cfJhnIAyefCr8qjelRyaFQo6nLvWsO1gUnEv6z6oYD36ufeax6HeMxObzl8jmPXuKVu2]--></g></svg>